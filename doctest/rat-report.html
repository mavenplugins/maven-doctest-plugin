<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia at Oct 25, 2012 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>RAT (Release Audit Tool) results</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
        <style>body{padding-top: 20px;}</style>
    
    <script type="text/javascript" src="./js/apache-maven-fluido.min.js"></script>

    
    <meta name="Date-Revision-yyyymmdd" content="20121025" />
    <meta http-equiv="Content-Language" content="en" />
    
        </head>
  <body>
        
    
        <div class="container-fluid">
                <div id="banner">
        <div class="pull-left">                                <a href="./" id="bannerLeft">
                <h2>Doctest Library</h2>
                </a>
      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>
      
      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
        
                  <li id="publishDate">Last Published: 2012-10-25</li>
                  <li class="divider">|</li> <li id="projectVersion">Version: 1.4.0</li>
                                      
        
              </ul>
      </div>

            <div id="leftColumn" class="sidebar">
        <div class="well">
                
        
                                   <h5>Parent Project</h5>
                  <ul>
                  <li class="none">
                          <a href="../index.html" title="Doctest Maven Plugin">Doctest Maven Plugin</a>
            </li>
          </ul>
                       <h5>Project Documentation</h5>
                  <ul>
                                                                                                                                                                                                                                                                                            <li class="collapsed">
                          <a href="project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                              <li class="expanded">
                          <a href="project-reports.html" title="Project Reports">Project Reports</a>
                    <ul>
                      <li class="none">
            <strong>RAT Report</strong>
          </li>
              </ul>
        </li>
          </ul>
                      
        
      
          
          <div id="poweredBy">
                                                                                                                  <a href="https://buildhive.cloudbees.com/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy"  alt="Built by Maven" src="http://www.cloudbees.com/sites/default/files/Button-Built-on-CB-1.png"    />
      </a>
                    </div>
        </div>
      </div>
      
      <div id="bodyColumn" class="content">
        <div id="contentBox">
                              
          <div class="section"><h2>RAT (Release Audit Tool) results<a name="RAT_Release_Audit_Tool_results"></a></h2><p>The following document contains the results of <a class="externalLink" href="http://incubator.apache.org/rat/apache-rat-plugin">RAT (Release Audit Tool)</a>.</p><p></p><div class="source"><pre class="prettyprint">
*****************************************************
Summary
-------
Generated at: 2012-10-25T17:13:29+02:00
Notes: 0
Binaries: 0
Archives: 0
Standards: 22

Apache Licensed: 0
Generated Documents: 0

JavaDocs are generated and so license header is optional
Generated files do not required license headers

22 Unknown Licenses

*******************************

Unapproved licenses:

  D:/git/maven-doctest-plugin/doctest/.gitignore
  D:/git/maven-doctest-plugin/doctest/pom.xml
  D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/AbstractRequestData.java
  D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/asserts/HttpResponseAssertUtils.java
  D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/asserts/JsonAssertUtils.java
  D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/asserts/XmlAssertUtils.java
  D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/Doctest.java
  D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/DoctestClient.java
  D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/DoctestConfig.java
  D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/DoctestOrder.java
  D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/DoctestRunner.java
  D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/expectations/ExpectHeader.java
  D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/expectations/ExpectHeaders.java
  D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/expectations/ExpectStatus.java
  D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/formatter/EntityFormatter.java
  D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/formatter/JsonPrettyPrinter.java
  D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/formatter/XmlPrettyPrinter.java
  D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/RequestData.java
  D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/RequestResultWrapper.java
  D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/ResponseResultWrapper.java
  D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/SimpleDoctest.java
  D:/git/maven-doctest-plugin/doctest/src/test/java/com/github/mavenplugins/doctest/MyDoctest.java

*******************************

Archives:

*****************************************************
  Files with Apache License headers will be marked AL
  Binary files (which do not require AL headers) will be marked B
  Compressed archives will be marked A
  Notices, licenses etc will be marked N
 !????? D:/git/maven-doctest-plugin/doctest/.gitignore
 !????? D:/git/maven-doctest-plugin/doctest/pom.xml
 !????? D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/AbstractRequestData.java
 !????? D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/asserts/HttpResponseAssertUtils.java
 !????? D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/asserts/JsonAssertUtils.java
 !????? D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/asserts/XmlAssertUtils.java
 !????? D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/Doctest.java
 !????? D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/DoctestClient.java
 !????? D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/DoctestConfig.java
 !????? D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/DoctestOrder.java
 !????? D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/DoctestRunner.java
 !????? D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/expectations/ExpectHeader.java
 !????? D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/expectations/ExpectHeaders.java
 !????? D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/expectations/ExpectStatus.java
 !????? D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/formatter/EntityFormatter.java
 !????? D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/formatter/JsonPrettyPrinter.java
 !????? D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/formatter/XmlPrettyPrinter.java
 !????? D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/RequestData.java
 !????? D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/RequestResultWrapper.java
 !????? D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/ResponseResultWrapper.java
 !????? D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/SimpleDoctest.java
 !????? D:/git/maven-doctest-plugin/doctest/src/test/java/com/github/mavenplugins/doctest/MyDoctest.java
 
 *****************************************************
 Printing headers for files without AL header...
 
 
 =======================================================================
 ==D:/git/maven-doctest-plugin/doctest/.gitignore
 =======================================================================
/.classpath
/.project
/.settings/
/target/

 =======================================================================
 ==D:/git/maven-doctest-plugin/doctest/pom.xml
 =======================================================================
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;parent&gt;
        &lt;artifactId&gt;parent&lt;/artifactId&gt;
        &lt;groupId&gt;com.github.mavenplugins.maven-doctest-plugin&lt;/groupId&gt;
        &lt;version&gt;1.4.0&lt;/version&gt;
        &lt;relativePath&gt;..&lt;/relativePath&gt;
    &lt;/parent&gt;
    &lt;name&gt;Doctest Library&lt;/name&gt;
    &lt;artifactId&gt;doctest&lt;/artifactId&gt;
    &lt;packaging&gt;jar&lt;/packaging&gt;
    
    &lt;properties&gt;
        &lt;commons.lang.version&gt;3.1&lt;/commons.lang.version&gt;
        &lt;commons.io.version&gt;2.1&lt;/commons.io.version&gt;
        &lt;jackson.version&gt;2.0.2&lt;/jackson.version&gt;
        &lt;jxpath.version&gt;1.3&lt;/jxpath.version&gt;
    &lt;/properties&gt;
    
    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;junit&lt;/groupId&gt;
            &lt;artifactId&gt;junit&lt;/artifactId&gt;
            &lt;version&gt;${junit.version}&lt;/version&gt;
            &lt;scope&gt;provided&lt;/scope&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.httpcomponents&lt;/groupId&gt;
            &lt;artifactId&gt;httpclient&lt;/artifactId&gt;
            &lt;version&gt;4.2&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.httpcomponents&lt;/groupId&gt;
            &lt;artifactId&gt;httpmime&lt;/artifactId&gt;
            &lt;version&gt;4.2&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;javax.jws&lt;/groupId&gt;
            &lt;artifactId&gt;jsr181-api&lt;/artifactId&gt;
            &lt;version&gt;1.0-MR1&lt;/version&gt;
            &lt;scope&gt;test&lt;/scope&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;javax.xml.ws&lt;/groupId&gt;
            &lt;artifactId&gt;jaxws-api&lt;/artifactId&gt;
            &lt;version&gt;2.2.8&lt;/version&gt;
            &lt;scope&gt;test&lt;/scope&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;

 =======================================================================
 ==D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/AbstractRequestData.java
 =======================================================================
package com.github.mavenplugins.doctest;

import static org.junit.Assert.fail;

import java.io.ByteArrayOutputStream;
import java.util.Map;

import org.apache.http.Header;
import org.apache.http.HttpEntity;
import org.apache.http.auth.Credentials;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.entity.ByteArrayEntity;
import org.apache.http.entity.ContentType;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.message.BasicHeader;
import org.apache.http.params.HttpParams;

import com.fasterxml.jackson.databind.ObjectMapper;

/**
 * An abstract implementation of a request configuration.
 */
public abstract class AbstractRequestData implements RequestData {
    
    /**
     * Gets a null back.
     */
    public HttpParams getParameters() {
        return null;
    }
    
    /**
     * Gets a &quot;GET&quot;.
     */
    public String getMethod() {
        return HttpGet.METHOD_NAME;
    }
    
    /**
     * Gets a null back.
     */
    public Header[] getHeaders() {
        return null;
    }
    
    /**
     * Gets a null back.
     */
    public HttpEntity getHttpEntity() {
        return null;

 =======================================================================
 ==D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/asserts/HttpResponseAssertUtils.java
 =======================================================================
package com.github.mavenplugins.doctest.asserts;

import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertTrue;

import java.util.regex.Pattern;

import org.apache.http.Header;
import org.apache.http.HttpResponse;

/**
 * This is an utility class used to check http responses.
 */
public class HttpResponseAssertUtils {
    
    /**
     * Checks the response for the existing of the specified header.
     * 
     * @param response the response
     * @param header the string chuck
     */
    public static void assertHeaderExists(HttpResponse response, String header) {
        assertHeaderExists(&quot;expected header '&quot; + header + '\'', response, header);
    }
    
    /**
     * Checks the response for the existing of the specified header.
     * 
     * @param response the response
     * @param header the string chuck
     * @param message the assert message
     */
    public static void assertHeaderExists(String message, HttpResponse response, String header) {
        assertTrue(message, response.containsHeader(header));
    }
    
    /**
     * Checks the response for the containment of the specified header and value.
     * 
     * @param response the response
     * @param header the string chuck
     * @param value the value the header should contain
     */
    public static void assertHeaderContains(HttpResponse response, String header, String value) {
        assertHeaderContains(&quot;expected header '&quot; + header + &quot;' with value '&quot; + value + '\'', response, header, value, 0);
    }
    
    /**
     * Checks the response for the containment of the specified header and value.
     * 

 =======================================================================
 ==D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/asserts/JsonAssertUtils.java
 =======================================================================
package com.github.mavenplugins.doctest.asserts;

import static org.junit.Assert.assertTrue;

import java.util.Iterator;
import java.util.Map;

import org.apache.commons.jxpath.JXPathContext;

import com.fasterxml.jackson.databind.JsonNode;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.node.TreeTraversingParser;

/**
 * This is an utility class used to check the elements of a given JSON node with XPath (using apache jxpath).
 */
public class JsonAssertUtils {
    
    /**
     * the object mapper (threadsafe)
     */
    private static final ObjectMapper MAPPER = new ObjectMapper();
    
    /**
     * Checks if the xpath expression results in at least 1 element.
     * 
     * @param node the json node.
     * @param xpath the expression
     */
    public static void assertExists(JsonNode node, String xpath) throws Exception {
        assertExists(null, node, xpath);
    }
    
    /**
     * Checks if the xpath expression results in at least 1 element.
     * 
     * @param node the json node.
     * @param xpath the expression
     * @param message the assert message
     */
    public static void assertExists(String message, JsonNode node, String xpath) throws Exception {
        assertTrue(message, count(message, node, xpath) &gt; 0);
    }
    
    /**
     * Counts the elements which results from the xpath expression.
     * 
     * @param node the xml document.
     * @param xpath the expression
     * @return Returns -1 if no element was found.

 =======================================================================
 ==D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/asserts/XmlAssertUtils.java
 =======================================================================
package com.github.mavenplugins.doctest.asserts;

import static org.junit.Assert.assertTrue;

import java.util.Map;
import java.util.TreeMap;

import javax.xml.xpath.XPathConstants;
import javax.xml.xpath.XPathExpression;
import javax.xml.xpath.XPathExpressionException;
import javax.xml.xpath.XPathFactory;

import org.w3c.dom.Document;
import org.w3c.dom.NodeList;

/**
 * This is an utility class used to check the elements of a given XML document with XPath.
 */
public class XmlAssertUtils {
    
    /**
     * the expression cache.
     */
    private static final Map&lt;String, XPathExpression&gt; EXPRESSIONS = new TreeMap&lt;String, XPathExpression&gt;();
    
    /**
     * Checks if the xpath expression results in at least 1 element.
     * 
     * @param document the xml document.
     * @param xpath the expression
     */
    public static void assertExists(Document document, String xpath) throws XPathExpressionException {
        assertExists(null, document, xpath);
    }
    
    /**
     * Checks if the xpath expression results in at least 1 element.
     * 
     * @param document the xml document.
     * @param xpath the expression
     * @param message the assert message
     */
    public static void assertExists(String message, Document document, String xpath) throws XPathExpressionException {
        assertTrue(message, count(message, document, xpath) &gt; 0);
    }
    
    /**
     * Counts the elements which results from the xpath expression.
     * 
     * @param document the xml document.

 =======================================================================
 ==D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/Doctest.java
 =======================================================================
package com.github.mavenplugins.doctest;

import java.lang.annotation.Documented;
import java.lang.annotation.ElementType;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Target;

import com.github.mavenplugins.doctest.formatter.EntityFormatter;

/**
 * Annotation for doctests.
 */
@Retention(RetentionPolicy.RUNTIME)
@Documented
@Target(ElementType.METHOD)
public @interface Doctest {
    
    /**
     * Gets the request configuration
     */
    Class&lt;? extends RequestData&gt;[] value();
    
    /**
     * Gets the formatter for the response.
     */
    Class&lt;? extends EntityFormatter&gt; formatter() default EntityFormatter.class;
    
}

 =======================================================================
 ==D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/DoctestClient.java
 =======================================================================
package com.github.mavenplugins.doctest;

import java.lang.annotation.Documented;
import java.lang.annotation.ElementType;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Target;

/**
 * Apache HTTP client configuration annotation for a doctest.
 */
@Retention(RetentionPolicy.RUNTIME)
@Documented
@Target(ElementType.METHOD)
public @interface DoctestClient {
    
    /**
     * Determines if the HTTP-client should follow redirects.
     */
    boolean handleRedirects() default true;
    
    /**
     * Determines if the HTTP-client should allow relative redirect locations.
     */
    boolean rejectRelativeRedirects() default false;
    
    /**
     * Determines if the HTTP-client should allow cyclic redirects.
     */
    boolean allowCircularRedirects() default true;
    
    /**
     * Determines the max. redirect-count.
     */
    int maxRedirects() default 100;
    
    /**
     * Allow compression or not.
     */
    boolean enableCompression() default true;
    
}

 =======================================================================
 ==D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/DoctestConfig.java
 =======================================================================
package com.github.mavenplugins.doctest;

import java.lang.annotation.Documented;
import java.lang.annotation.ElementType;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Target;

/**
 * Configuration for doctest execution.
 */
@Retention(RetentionPolicy.RUNTIME)
@Documented
@Target(ElementType.METHOD)
public @interface DoctestConfig {
    
    /**
     * This enum is used to determine which response is given to the test-method.
     */
    public enum AssertionMode {
        /**
         * The first incoming response.
         */
        FIRST,
        /**
         * Any response can be given to the test-method.
         */
        RANDOM,
        /**
         * The last incoming response.
         */
        LAST
    }
    
    /**
     * Determines how many requests should be performed.
     */
    int requestCount() default 1;
    
    /**
     * Determines how many connections (and threads) should be used.
     */
    int maxConcurrentRequests() default 1;
    
    /**
     * Determines the delay between the requests per thread in milliseconds.
     */
    int requestDelay() default 0;
    
    /**

 =======================================================================
 ==D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/DoctestOrder.java
 =======================================================================
package com.github.mavenplugins.doctest;

import java.lang.annotation.Documented;
import java.lang.annotation.ElementType;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Target;

/**
 * Annotation for the order of doctest in the same testclass.
 * A lesser value will be executed earlier that a higher value.
 * Doctest methods without an order will be treated as they have the value 0.
 */
@Retention(RetentionPolicy.RUNTIME)
@Documented
@Target(ElementType.METHOD)
public @interface DoctestOrder {
    
    /**
     * The order value.
     */
    int value() default 0;
    
}

 =======================================================================
 ==D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/DoctestRunner.java
 =======================================================================
package com.github.mavenplugins.doctest;

import static org.junit.Assert.assertEquals;
import static org.junit.Assert.fail;

import java.io.ByteArrayInputStream;
import java.io.File;
import java.io.IOException;
import java.io.PrintStream;
import java.lang.reflect.Constructor;
import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Modifier;
import java.net.URI;
import java.net.URISyntaxException;
import java.util.ArrayList;
import java.util.Collections;
import java.util.Comparator;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.concurrent.Callable;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.Future;
import java.util.concurrent.TimeUnit;
import java.util.prefs.Preferences;

import javax.xml.bind.JAXBContext;
import javax.xml.bind.Unmarshaller;
import javax.xml.parsers.DocumentBuilderFactory;
import javax.xml.parsers.ParserConfigurationException;

import org.apache.http.Header;
import org.apache.http.HttpEntity;
import org.apache.http.HttpException;
import org.apache.http.HttpRequest;
import org.apache.http.HttpRequestInterceptor;
import org.apache.http.HttpResponse;
import org.apache.http.auth.AuthScope;
import org.apache.http.client.methods.HttpDelete;
import org.apache.http.client.methods.HttpEntityEnclosingRequestBase;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.client.methods.HttpHead;
import org.apache.http.client.methods.HttpOptions;
import org.apache.http.client.methods.HttpPatch;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.client.methods.HttpPut;
import org.apache.http.client.methods.HttpRequestBase;
import org.apache.http.client.methods.HttpTrace;
import org.apache.http.client.params.ClientPNames;

 =======================================================================
 ==D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/expectations/ExpectHeader.java
 =======================================================================
package com.github.mavenplugins.doctest.expectations;

/**
 * A single header (key / value) representation.
 */
public @interface ExpectHeader {
    
    /**
     * The name of the header.
     */
    String name();
    
    /**
     * A regExp used to determine the correct header value.
     */
    String content() default &quot;&quot;;
    
}

 =======================================================================
 ==D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/expectations/ExpectHeaders.java
 =======================================================================
package com.github.mavenplugins.doctest.expectations;

import java.lang.annotation.Documented;
import java.lang.annotation.ElementType;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Target;

/**
 * A method annotation used to automatically verify the correct headers.
 */
@Documented
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.METHOD)
public @interface ExpectHeaders {
    
    /**
     * the headers to verify.
     */
    ExpectHeader[] value();
    
}

 =======================================================================
 ==D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/expectations/ExpectStatus.java
 =======================================================================
package com.github.mavenplugins.doctest.expectations;

import java.lang.annotation.Documented;
import java.lang.annotation.ElementType;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Target;

/**
 * A method annotation used to automatically verify the correct response code.
 */
@Documented
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.METHOD)
public @interface ExpectStatus {
    
    /**
     * The http response status code.
     */
    int value();
    
    /**
     * A regExp representing the response message.
     */
    String message() default &quot;&quot;;
    
}

 =======================================================================
 ==D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/formatter/EntityFormatter.java
 =======================================================================
package com.github.mavenplugins.doctest.formatter;

import org.apache.http.HttpEntity;

/**
 * An EntityFormatter is responsible for formatting a response.
 */
public interface EntityFormatter {
    
    /**
     * Actually formats the given responseData.
     * 
     * @param entity The entity where the response came from.
     * @param responseData The raw response data - some Entity-objects doesn't support multiple read operations.
     */
    String format(HttpEntity entity, byte[] responseData) throws Exception;
    
}

 =======================================================================
 ==D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/formatter/JsonPrettyPrinter.java
 =======================================================================
package com.github.mavenplugins.doctest.formatter;

import org.apache.http.HttpEntity;

import com.fasterxml.jackson.core.util.DefaultPrettyPrinter;
import com.fasterxml.jackson.databind.ObjectMapper;

/**
 * Formats the response as a pretty printed JSON.
 */
public class JsonPrettyPrinter implements EntityFormatter {
    
    /**
     * The JSON mapper (threadsafe) used to stringify the response.
     */
    protected ObjectMapper mapper = new ObjectMapper();
    
    /**
     * Returns an empty string if the response data is empty.
     */
    public String format(HttpEntity entity, byte[] responseData) throws Exception {
        if (responseData != null &amp;&amp; responseData.length &gt; 0) {
            return mapper.writer(new DefaultPrettyPrinter()).writeValueAsString(mapper.readTree(responseData));
        }
        return &quot;&quot;;
    }
    
}

 =======================================================================
 ==D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/formatter/XmlPrettyPrinter.java
 =======================================================================
package com.github.mavenplugins.doctest.formatter;

import java.io.ByteArrayInputStream;
import java.io.StringWriter;

import javax.xml.transform.OutputKeys;
import javax.xml.transform.Transformer;
import javax.xml.transform.TransformerConfigurationException;
import javax.xml.transform.TransformerFactory;
import javax.xml.transform.TransformerFactoryConfigurationError;
import javax.xml.transform.stream.StreamResult;
import javax.xml.transform.stream.StreamSource;

import org.apache.http.HttpEntity;

/**
 * Formats the given xml data using indentation.
 */
public class XmlPrettyPrinter implements EntityFormatter {
    
    /**
     * The standard XML formatter.
     */
    protected Transformer transformer;
    
    /**
     * Sets up the transformer.
     */
    public XmlPrettyPrinter() throws TransformerConfigurationException, TransformerFactoryConfigurationError {
        transformer = TransformerFactory.newInstance().newTransformer();
        transformer.setOutputProperty(OutputKeys.INDENT, &quot;yes&quot;);
        transformer.setOutputProperty(OutputKeys.METHOD, &quot;xml&quot;);
    }
    
    /**
     * Returns an empty string if the response data is empty.
     */
    public String format(HttpEntity entity, byte[] responseData) throws Exception {
        StringWriter writer = new StringWriter();
        if (responseData != null &amp;&amp; responseData.length &gt; 0) {
            transformer.transform(new StreamSource(new ByteArrayInputStream(responseData)), new StreamResult(writer));
        }
        return writer.toString();
    }
    
}

 =======================================================================
 ==D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/RequestData.java
 =======================================================================
package com.github.mavenplugins.doctest;

import java.net.URI;
import java.net.URISyntaxException;

import org.apache.http.Header;
import org.apache.http.HttpEntity;
import org.apache.http.auth.Credentials;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.params.HttpParams;

/**
 * Represents the configuration for a doctest request.
 */
public interface RequestData {
    
    /**
     * Gets the uri for a doctest.
     */
    URI getURI() throws URISyntaxException;
    
    /**
     * Gets the string representation for a http method.
     */
    String getMethod();
    
    /**
     * Gets the request parameters.
     */
    HttpParams getParameters();
    
    /**
     * Gets the request headers.
     */
    Header[] getHeaders();
    
    /**
     * Gets the entity (form data) for post or put requests.
     */
    HttpEntity getHttpEntity();
    
    /**
     * Gets the authentication credentials.
     */
    Credentials getCredentials();
    
    /**
     * Configures the client as needed.
     */
    void configureClient(DefaultHttpClient client);

 =======================================================================
 ==D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/RequestResultWrapper.java
 =======================================================================
package com.github.mavenplugins.doctest;

/**
 * A wrapper for the request, which stores the states for the later report plugin.
 */
public class RequestResultWrapper {
    
    protected String path;
    protected String requestLine;
    protected String[] header;
    protected String[] paremeters;
    protected String entity;
    
    public String getPath() {
        return path;
    }
    
    public void setPath(String path) {
        this.path = path;
    }
    
    public String getRequestLine() {
        return requestLine;
    }
    
    public void setRequestLine(String requestLine) {
        this.requestLine = requestLine;
    }
    
    public String[] getHeader() {
        return header;
    }
    
    public void setHeader(String[] header) {
        this.header = header;
    }
    
    public String[] getParemeters() {
        return paremeters;
    }
    
    public void setParemeters(String[] paremeters) {
        this.paremeters = paremeters;
    }
    
    public String getEntity() {
        return entity;
    }
    
    public void setEntity(String entity) {

 =======================================================================
 ==D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/ResponseResultWrapper.java
 =======================================================================
package com.github.mavenplugins.doctest;

/**
 * A wrapper for the response, which stores the states for the later report plugin.
 */
public class ResponseResultWrapper {
    
    protected String statusLine;
    protected String[] header;
    protected String[] paremeters;
    protected String entity;
    
    public String getStatusLine() {
        return statusLine;
    }
    
    public void setStatusLine(String responseLine) {
        statusLine = responseLine;
    }
    
    public String[] getHeader() {
        return header;
    }
    
    public void setHeader(String[] header) {
        this.header = header;
    }
    
    public String[] getParemeters() {
        return paremeters;
    }
    
    public void setParemeters(String[] paremeters) {
        this.paremeters = paremeters;
    }
    
    public String getEntity() {
        return entity;
    }
    
    public void setEntity(String entity) {
        this.entity = entity;
    }
    
}

 =======================================================================
 ==D:/git/maven-doctest-plugin/doctest/src/main/java/com/github/mavenplugins/doctest/SimpleDoctest.java
 =======================================================================
package com.github.mavenplugins.doctest;

import java.lang.annotation.Documented;
import java.lang.annotation.ElementType;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Target;

import org.apache.http.client.methods.HttpGet;

import com.github.mavenplugins.doctest.formatter.EntityFormatter;

/**
 * Annotation for simple doctests.
 */
@Retention(RetentionPolicy.RUNTIME)
@Documented
@Target(ElementType.METHOD)
public @interface SimpleDoctest {
    
    /**
     * Gets the request url.
     */
    String value();
    
    /**
     * Gets the request headers (header/value pairs).
     */
    String[] header() default {};
    
    /**
     * Gets the request method.
     */
    String method() default HttpGet.METHOD_NAME;
    
    /**
     * Gets the formatter for the response.
     */
    Class&lt;? extends EntityFormatter&gt; formatter() default EntityFormatter.class;
    
}

 =======================================================================
 ==D:/git/maven-doctest-plugin/doctest/src/test/java/com/github/mavenplugins/doctest/MyDoctest.java
 =======================================================================
package com.github.mavenplugins.doctest;

import java.net.URI;
import java.net.URISyntaxException;

import javax.jws.WebService;
import javax.xml.ws.Endpoint;

import org.apache.http.HttpResponse;
import org.junit.After;
import org.junit.Before;
import org.junit.runner.RunWith;
import org.w3c.dom.Document;

import com.github.mavenplugins.doctest.expectations.ExpectHeader;
import com.github.mavenplugins.doctest.expectations.ExpectHeaders;
import com.github.mavenplugins.doctest.expectations.ExpectStatus;
import com.github.mavenplugins.doctest.formatter.XmlPrettyPrinter;

@RunWith(DoctestRunner.class)
public class MyDoctest {
    
    class Resource1 extends AbstractRequestData {
        
        public URI getURI() throws URISyntaxException {
            return new URI(&quot;http://localhost:8080/someService?wsdl&quot;);
        }
        
    }
    
    /*
     * SERVER FOR TESTING (JUST AN EXAMPLE)
     */
    
    @WebService
    public static class SimpleService {
        
        public int multiply(int x, int y) {
            return x * y;
        }
        
    }
    
    Endpoint endpoint;
    
    @Before
    public void startServer() throws Exception {
        SimpleService service = new SimpleService();
        endpoint = Endpoint.publish(&quot;http://localhost:8080/someService&quot;, service);
    }
</pre></div></div>
                  </div>
      </div>
    </div>

    <footer class="footer">
            <div class="container-fluid">
              <div class="row span16">Copyright &copy;                   2012.
          All Rights Reserved.      
        
      </div>

                      </div>
    </footer>
  </body>
</html>
